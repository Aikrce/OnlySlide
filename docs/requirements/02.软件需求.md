
# OnlySlide 软件需求说明书 (SRS) - 更新版

## 1. 引言

### 1.1 目的
本文档详细描述OnlySlide应用的功能和非功能需求，为开发团队提供明确的技术指导和架构框架，确保开发过程遵循既定的设计原则和最佳实践。

### 1.2 范围
OnlySlide是一款基于模块化MVVM架构的演示文稿创建应用，专注于PPT风格分析和应用功能，支持iOS 18+和macOS 15+平台。本文档涵盖从MVP(v1.0)到后续v1.5和v2.0版本的功能规划。

### 1.3 定义与缩写
- **MVVM**: Model-View-ViewModel架构模式
- **DRY**: Don't Repeat Yourself (避免代码重复)原则 
- **SRP**: Single Responsibility Principle (单一职责原则)
- **SwiftUI**: Apple的声明式UI框架
- **MVP**: Minimum Viable Product (最小可行产品)

## 2. 系统描述

### 2.1 产品概述
OnlySlide旨在解决教育工作者和设计师在创建多个保持风格一致的演示文稿时面临的效率和一致性问题。应用通过分析现有PPT的风格元素，并将其应用到新内容中，实现风格的一致性复用。

### 2.2 主要功能与版本规划

#### v1.0 MVP核心功能 [预计3个月]
- 基础模板导入与风格元素提取(颜色、字体)
- 基本文本和图形编辑功能
- 基础幻灯片导航与组织
- 本地存储与自动保存
- 基础导出功能(PDF/图像)

#### v1.5 增强功能 [预计+3个月]
- 高级风格分析
- 基础AI辅助功能
- 内容导入增强
- 简单图表创建
- iCloud基础同步

#### v2.0 高级功能 [预计+4个月]
- 高级AI排版与内容建议
- 完整跨设备同步
- 基础共享与评论功能
- 高级图表与数据可视化
- 扩展导出格式支持

### 2.3 用户群体
- 教育工作者（优先级高）：需要批量创建统一风格课件
- 设计效率追求者（次优先级）：需要维持品牌一致性的专业人士

### 2.4 技术约束
- iOS 18+、macOS 15+
- SwiftUI作为UI框架
- 模块化MVVM架构模式
- 模块化Package设计（OnlySlideCore、OnlySlideUI）

### 2.5 设计与实现约束

#### 2.5.1 架构约束
- 采用模块化MVVM架构：系统级采用模块化架构，UI层内部实现MVVM模式
- 系统分为OnlySlideCore和OnlySlideUI两大模块：Core包含所有业务逻辑，UI包含所有界面元素
- 模块依赖单向流：OnlySlideUI可依赖OnlySlideCore，但反之不允许
- OnlySlideUI内部严格遵循MVVM架构：View仅负责UI呈现，ViewModel连接Core服务和Views
- 契约式编程：所有模块间通信通过协议定义接口，实现依赖抽象而非具体类型

#### 2.5.2 代码质量约束
- 文件大小限制: 单个Swift文件不得超过300-400行代码
- 单一职责原则: 每个类和函数只负责单一功能，避免创建"上帝类"
- 代码风格规范: 项目必须集成SwiftLint并通过配置强制执行团队代码风格
- 测试覆盖要求: 核心业务逻辑必须达到80%以上的测试覆盖率
- 编译警告处理: 所有编译警告必须解决，不允许忽略警告

#### 2.5.3 技术栈约束
- UI框架: 必须使用SwiftUI构建所有用户界面，避免混合UIKit/AppKit
- 数据持久化: 使用CoreData作为本地数据存储方案
- Swift版本: 使用Swift 5.0，利用最新的语言特性
- 异步操作: 使用Swift并发模型(async/await)处理所有异步操作，避免回调地狱
- 依赖管理: 外部依赖必须经过评审，优先使用原生框架

#### 2.5.4 平台适配约束
- 设备支持: 必须同时支持iOS 18+和macOS 15+
- 平台特性: 在保持核心功能一致的前提下，必须针对不同平台特性优化:
  - iOS: 优化触摸操作，支持手势编辑，考虑屏幕空间限制
  - macOS: 提供键盘快捷键支持，利用大屏幕空间，优化精确鼠标操作
- 响应式设计: UI必须适配所有支持的设备尺寸和方向

#### 2.5.5 开发流程约束
- "童子军规则": 每次修改代码都应使其比之前更整洁
- 代码审查: 所有代码必须经过至少一名团队成员审查后才能合并
- 自动化测试: 每次提交必须通过自动化测试流水线
- 文档要求: 所有公共API必须包含文档注释，关键设计决策需记录理由
- 持续重构: 每个开发周期分配15-20%的时间用于技术债务管理和重构

#### 2.5.6 SwiftUI特定约束
- 状态管理规范: 明确定义状态管理策略，正确使用@State、@ObservedObject等
- 视图组件复用: 创建可复用视图组件库，使用ViewModifier统一样式
- 视图分解: 复杂视图必须分解为多个小型组件，单个视图文件不超过150行
- 环境变量使用: 合理使用环境变量，避免过度依赖全局状态

#### 2.5.7 性能约束
- 启动时间: 应用冷启动不超过3秒
- 响应时间: UI操作响应时间不超过100ms
- 内存使用: 在标准设备上运行时内存占用不超过200MB
- 电池优化: 应用在后台时必须最小化资源消耗

## 3. 系统架构

### 3.1 模块化MVVM架构实现

#### 3.1.1 OnlySlideCore模块
- 包含所有Model和业务服务
- 负责数据结构和业务逻辑
- 包括PPT解析和风格提取功能
- 不包含任何UI相关代码
- 通过协议向UI模块提供服务

#### 3.1.2 OnlySlideUI模块（采用MVVM模式）
##### View层
- 使用SwiftUI实现用户界面组件
- 通过绑定从ViewModel获取数据
- 将用户操作转发给ViewModel
- 不包含业务逻辑

##### ViewModel层
- 作为View和Core服务的中介
- 处理UI状态和用户操作响应
- 通过依赖注入使用Core服务
- 提供可绑定的属性供View使用

##### Models引用
- 从OnlySlideCore引用数据模型
- 处理模型在UI层的表示形式

### 3.2 包结构与设计

#### 3.2.1 OnlySlideCore包
- 所有业务逻辑和数据处理功能
- 模板分析和生成引擎
- 数据模型定义
- 不依赖UI框架

#### 3.2.2 OnlySlideUI包
- 所有界面相关代码
- 可复用视图组件
- ViewModifier定义
- 依赖OnlySlideCore但不向其暴露UI概念

### 3.3 契约式编程

#### 3.3.1 核心协议
- SlideTemplateAnalyzing
- ContentStructuring
- SlideGenerating
- StyleExtracting

#### 3.3.2 协议实现与依赖注入
- 所有核心组件通过协议而非具体类型进行引用
- 使用依赖注入简化测试和维护

## 4. 详细功能需求

### 4.1 文件管理功能

#### 4.1.1 文件导入 [优先级: P0 - v1.0 MVP]
- 支持导入.pptx格式文件
- 支持从多种来源选择文件（iCloud、本地存储等）
- 提供文件预览功能

#### 4.1.2 模板管理 [优先级: P1 - v1.5]
- 提供模板库管理
- 支持模板收藏和分类
- 提供模板历史记录

### 4.2 PPT分析功能

#### 4.2.1 风格元素提取
- 自动提取配色方案 [优先级: P0 - v1.0 MVP]
- 分析字体选择和排版规则 [优先级: P0 - v1.0 MVP]
- 提取排版布局和视觉元素 [优先级: P1 - v1.5]

#### 4.2.2 风格模型生成
- 生成标准化风格元数据模型 [优先级: P0 - v1.0 MVP]
- 提供风格预览功能 [优先级: P0 - v1.0 MVP]
- 支持风格微调 [优先级: P1 - v1.5]

#### 4.2.3 内容结构分析 [优先级: P1 - v1.5]
- 分析文本内容的层级结构
- 识别逻辑关系和组织方式
- 提取文本样式规则

### 4.3 内容处理功能

#### 4.3.1 文本导入
- 支持纯文本导入 [优先级: P0 - v1.0 MVP]
- 支持富文本格式导入 [优先级: P1 - v1.5]
- 支持Markdown格式导入 [优先级: P2 - v2.0]

#### 4.3.2 内容结构化
- 基础内容层级结构管理 [优先级: P0 - v1.0 MVP]
- 提供手动调整结构功能 [优先级: P0 - v1.0 MVP]
- 自动识别内容层级结构 [优先级: P1 - v1.5]
- 支持内容拖拽重组 [优先级: P1 - v1.5]

#### 4.3.3 内容分配
- 基础内容分配到幻灯片 [优先级: P0 - v1.0 MVP]
- 根据内容类型选择基础布局 [优先级: P0 - v1.0 MVP]
- 智能内容分配算法 [优先级: P1 - v1.5]
- 支持手动调整内容分配 [优先级: P1 - v1.5]

### 4.4 PPT生成功能

#### 4.4.1 风格应用
- 将基础风格元素应用到内容 [优先级: P0 - v1.0 MVP]
- 保持基本视觉一致性 [优先级: P0 - v1.0 MVP]
- 根据内容类型选择适当风格变体 [优先级: P1 - v1.5]

#### 4.4.2 布局适配
- 基础内容布局 [优先级: P0 - v1.0 MVP]
- 处理文本溢出情况 [优先级: P0 - v1.0 MVP]
- 自动适配内容到合适布局 [优先级: P1 - v1.5]
- 维持内容可读性和视觉平衡 [优先级: P1 - v1.5]

#### 4.4.3 多媒体支持
- 支持基础图片插入 [优先级: P0 - v1.0 MVP]
- 支持基本图表生成 [优先级: P1 - v1.5]
- 保持多媒体元素风格一致性 [优先级: P1 - v1.5]
- 高级图表与数据可视化 [优先级: P2 - v2.0]

#### 4.4.4 编辑与调整
- 提供基础编辑界面 [优先级: P0 - v1.0 MVP]
- 支持幻灯片添加、删除和重排 [优先级: P0 - v1.0 MVP]
- 支持元素位置、大小调整 [优先级: P0 - v1.0 MVP]
- 高级样式调整 [优先级: P1 - v1.5]

### 4.5 AI辅助功能 [全部为v1.5及以后版本]

#### 4.5.1 内容改进 [优先级: P1 - v1.5]
- 分析并提供内容简洁性和清晰度建议
- 识别并标注可能的语法错误
- 提供措辞优化建议 [优先级: P2 - v2.0]

#### 4.5.2 结构优化 [优先级: P1 - v1.5]
- 分析内容逻辑顺序并提供优化建议
- 建议信息层级调整
- 提供内容分组和分页建议

#### 4.5.3 设计增强 [优先级: P2 - v2.0]
- 提供视觉平衡改进建议
- 建议强调关键信息的方法
- 提供整体设计一致性建议

#### 4.5.4 演讲备注 [优先级: P2 - v2.0]
- 根据幻灯片内容自动生成演讲备注
- 提供备注编辑界面
- 支持备注导出

### 4.6 导出与分享功能

#### 4.6.1 文件导出
- 支持导出为PDF格式 [优先级: P0 - v1.0 MVP]
- 支持导出为图片集 [优先级: P0 - v1.0 MVP]
- 支持导出为.pptx格式 [优先级: P1 - v1.5]
- 支持导出为.key格式 [优先级: P2 - v2.0]

#### 4.6.2 分享功能
- 支持通过AirDrop分享 [优先级: P0 - v1.0 MVP]
- 支持通过邮件分享 [优先级: P0 - v1.0 MVP]
- 支持存储到iCloud Drive [优先级: P1 - v1.5]
- 支持与常用应用的集成分享 [优先级: P1 - v1.5]
- 查看共享链接功能 [优先级: P2 - v2.0]

### 4.7 数据同步与版本管理

#### 4.7.1 本地存储 [优先级: P0 - v1.0 MVP]
- 本地保存与加载功能
- 自动保存功能
- 基础版本管理

#### 4.7.2 云同步 [优先级: P1 - v1.5]
- iCloud基础同步
- 版本历史记录
- 设备间同步

#### 4.7.3 协作功能 [优先级: P2 - v2.0及未来]
- 基础评论功能
- 查看共享文档
- 冲突检测与解决

## 5. 非功能需求

### 5.1 性能需求

#### 5.1.1 响应时间
- 系统启动时间不超过3秒
- PPT风格分析时间不超过10秒(基础风格元素，v1.0)
- PPT风格分析时间不超过30秒(高级风格分析，v1.5及以后)
- 内容生成过程不超过20秒(MVP版本)
- 内容生成过程不超过60秒(完整功能，v1.5及以后)

#### 5.1.2 资源使用
- 内存占用不超过200MB
- CPU使用率峰值不超过50%
- 存储空间使用合理

#### 5.1.3 可扩展性
- 系统应能处理至少100页的演示文稿
- 应支持同时处理多个项目

### 5.2 可靠性需求

#### 5.2.1 错误处理
- 系统崩溃率低于1%
- 具备错误恢复机制
- 提供明确的错误信息

#### 5.2.2 数据保护
- 自动保存工作进度，至少每2分钟一次
- 意外关闭后能恢复工作状态
- 提供文件版本历史

### 5.3 安全性需求

#### 5.3.1 数据安全
- 用户数据存储在设备本地
- 分析的PPT内容不上传服务器(除非用户明确同意)
- 符合数据保护法规要求

#### 5.3.2 隐私保护
- 遵循Apple的隐私准则
- 明确获取必要的用户权限
- 提供隐私政策说明

### 5.4 可用性需求

#### 5.4.1 用户界面
- 符合Apple Human Interface Guidelines
- 支持所有平台的无障碍功能
- 操作流程简洁直观

#### 5.4.2 用户体验
- 提供上下文帮助和提示
- 操作反馈及时清晰
- 学习曲线平缓

## 6. 用户界面要求

### 6.1 平台特定优化

#### 6.1.1 iOS界面
- 触摸优化界面
- 支持手势操作
- 考虑屏幕空间限制
- 支持iPad分屏功能 [v1.5]

#### 6.1.2 macOS界面
- 支持键盘快捷键
- 优化精确鼠标操作
- 利用大屏幕空间
- 支持多窗口工作流 [v1.5]

### 6.2 通用界面要求

#### 6.2.1 布局与组织
- 清晰的视觉层次结构
- 一致的导航模式
- 符合人体工程学的控件布局

#### 6.2.2 视觉设计
- 使用OnlySlideUI包中定义的样式
- 通过ViewModifier保持一致性
- 支持暗色模式适配

#### 6.2.3 交互设计
- 提供即时视觉反馈
- 支持撤销/重做功能
- 显示操作进度指示器

## 7. 质量要求与最佳实践

### 7.1 代码质量控制

#### 7.1.1 自动化工具
- 集成SwiftLint检测代码风格
- 使用编译时断言验证状态
- 启用Xcode所有警告

#### 7.1.2 测试策略
- 单元测试覆盖核心业务逻辑
- UI测试验证用户界面功能
- 性能测试确保满足性能需求

### 7.2 开发原则

#### 7.2.1 DRY原则实施
- 创建工具类和扩展提取共享逻辑
- 使用泛型和协议扩展处理相似功能
- 集中式数据转换，避免重复转换代码

#### 7.2.2 持续重构
- 遵循"童子军规则"
- 进行小步重构
- 记录重要设计决策和理由

#### 7.2.3 SwiftUI最佳实践
- 创建可复用视图组件
- 正确管理状态（@State, @ObservedObject等）
- 隔离业务逻辑与UI

## 8. 实施计划

### 8.1 MVP阶段 (v1.0) - 总计3个月

#### 8.1.1 准备阶段（1-2周）
- 设置SwiftLint和代码风格规范
- 创建基础架构文档
- 建立Git提交规范
- 完成核心模块API设计

#### 8.1.2 构建阶段（3-6周）
- 实现基础项目架构
- 创建核心数据模型
- 开发PPTX导入与基础风格提取
- 搭建基础UI框架

#### 8.1.3 功能实现阶段（7-10周）
- 实现基础内容编辑功能
- 开发风格应用基础功能
- 构建基础导出功能
- 实现本地存储

#### 8.1.4 完善阶段（11-12周）
- 性能优化
- 跨平台基础适配
- 错误处理与恢复
- 功能测试与修复

### 8.2 增强阶段 (v1.5) - 3个月

#### 8.2.1 高级功能（1-4周）
- 高级风格分析
- 基础AI功能实现
- 内容导入增强
- 简单图表创建

#### 8.2.2 云同步（5-8周）
- iCloud基础同步
- 版本历史记录
- 跨设备优化

#### 8.2.3 平台优化（9-12周）
- iOS分屏支持
- macOS多窗口
- 导出增强功能

### 8.3 高级功能阶段 (v2.0) - 4个月

#### 8.3.1 AI高级功能（1-5周）
- 高级内容分析
- 设计增强建议
- 演讲备注生成

#### 8.3.2 协作基础（6-10周）
- 基础共享功能
- 评论系统
- 冲突检测

#### 8.3.3 高级可视化（11-16周）
- 高级图表支持
- 数据可视化工具
- 导出扩展格式

## 9. 验收标准

### 9.1 MVP (v1.0) 验收标准
- 成功导入PPTX并提取基础风格元素
- 能够创建新演示文稿并应用提取的风格
- 基础文本和图形编辑功能正常工作
- 成功导出为PDF和图像格式
- 响应时间和性能符合要求
- 基础平台适配完成

### 9.2 代码质量验收
- SwiftLint检查无警告
- MVP核心功能测试覆盖率达到80%以上
- 代码审查通过
- 无严重内存泄漏

### 9.3 用户体验验收
- 用户任务完成时间符合预期
- 用户满意度评分达到85%以上
- 无严重可用性问题

## 10. 附录

### 10.1 参考资料
- Apple Human Interface Guidelines
- Swift API Design Guidelines
- MVVM架构参考文档

### 10.2 优先级与版本定义
- **P0 (必须实现)**: MVP (v1.0) 核心功能，影响产品基本可用性
- **P1 (应该实现)**: v1.5 版本功能，重要但不影响核心使用
- **P2 (可以实现)**: v2.0 及未来版本功能，增强产品竞争力

### 10.3 功能矩阵
参见项目文档库中的"OnlySlide统一功能矩阵"文档，该矩阵是所有功能规划和优先级的单一事实来源。
